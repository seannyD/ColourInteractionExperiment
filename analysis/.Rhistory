data=variants, family=poisson)
# Add try marking
m4 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach) + (TryMarked)
+ (1 | colourName) ,
data=variants, family=poisson)
# Add the interaction between teaching and try marking
m5 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
Teach * TryMarked
+ (1 | colourName) ,
data=variants, family=poisson)
# Add the average length of the sign
m6 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter +
(1 | colourName) ,
data=variants, family=poisson)
# Add checks
m7 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any
+ (1 | colourName) ,
data=variants, family=poisson)
# Add the identity of the first signer to use the variant
m8 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 | colourName) ,
data=variants, family=poisson)
# Add interaction between teaching and checking
m9 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any
+ (1 | colourName) ,
data=variants, family=poisson)
# Add interaction between try marking and checking
m10 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
check.any : TryMarked
+ (1 | colourName) ,
data=variants, family=poisson)
# Add 3 way interaction for teaching, checking and try marking
m11 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach * check.any * TryMarked
+ (1 | colourName) ,
data=variants, family=poisson)
```
# Results
Model comparison test:
```{r}
anova(m0,m1,m2,m3,m4,m5, m6,m7,m8, m9, m10, m11)
```
Inside the chosen final model (m10 and 11 add many parameters and do not improve the model, so we choose m9):
```{r}
summary(m9)
```
See how well the model predictions match the real data:
```{r}
plot(variants$freq_week_4, exp(predict(m9)),
xlab="Actual frequency",
ylab="Model prediction")
```
## Random slopes
For each of the predictors, we see if random slopes help improve the model.  Random slopes allow the strenght of the effect of a factor to be different for each colour concept.
```{r randomSlopes, cache=T}
m8R = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy+
Teach : check.any
+ (1 | colourName) ,
data=variants, family=poisson)
# Some convergence issues with this model, so use
# bobyqa algorithm for both steps.
m8R.indexical = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + indexical | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.indexical)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.TryMark = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + TryMarked| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.TryMark)
m8R.Freq = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + freq_week_1_total| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Freq)
m8R.Length = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + averageLength_week_1.logcenter| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Length)
m8R.Check = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + check.any| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "Nelder_Mead",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Check)
dotplot(ranef(m8R.Teach))
dotplot(ranef(m8R.Teach))
dotplot(ranef(m8R.Teach))
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach | colourName) +
(0 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach || colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1| colourName) +
(0 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1| colourName) +
(0 + Teach || colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
dotplot(ranef(m8R.Teach))
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach|| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
dotplot(ranef(m8R.Teach))
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy+
Teach : check.any
+ (1 | colourName) ,
data=variants, family=poisson)
# Some convergence issues with this model, so use
# bobyqa algorithm for both steps.
m8R.indexical = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + indexical | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.indexical)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + Teach| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.TryMark = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + TryMarked| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.TryMark)
m8R.Freq = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + freq_week_1_total| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Freq)
m8R.Length = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + averageLength_week_1.logcenter| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Length)
m8R.Check = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 | colourName) +
(0 + check.any| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "Nelder_Mead",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Check)
dotplot(ranef(m8R.TryMark))
head(variants$TryMarked)
table(variants$TryMarked)
dotplot(ranef(m8R.Teach))
finalModel = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + indexical || colourName) +
(0 + TryMarked | colourName) +
(0 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
finalModel = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + indexical + TryMarked + Teach || colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
dotplot(ranef(finalModel))
finalModel = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
(1 + indexical + TryMarked + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
dotplot(ranef(finalModel))
coef(summary(finalModel))[,1:3]
coef(summary(finalModel))
dotplot(ranef(finalModel))
plot(variants$freq_week_4, exp(predict(finalModel)),
xlab="Actual frequency",
ylab="Model prediction")
getMEText(anova(m0,m1), "main effect of frequency in week 1",summary(finalModel)$coef['freq_week_1_total',])
summary(m1)
getMEText(anova(m0,m1), "main effect of frequency in week 1",summary(finalModel)$coef['freq_week_1_total',])
getMEText(anova(m1,m2), "main effect of indexicality",summary(finalModel)$coef['indexicalYes',])
summary(finalModel)$coef['indexicalYes',]
summary(finalModel)$coef['indexicalYes-body',]
summary(finalModel)$coef
getMEText(anova(m2,m3), "main effect of teaching",summary(finalModel)$coef['TeachTRUE',])
getMEText(anova(m3,m4), "main effect of try marking",summary(finalModel)$coef['TryMarked',])
getMEText(anova(m5,m6), "main effect of sign length",summary(finalModel)$coef['averageLength_week_1.logcenter',])`
getMEText(anova(m5,m6), "main effect of sign length",summary(finalModel)$coef['averageLength_week_1.logcenter',])
getMEText = function(r,ef, wald=NULL, showWaldP=F){
AIC = r[2,]$AIC
loglikDiff = signif(diff(r$logLik),2)
chi = round(r$Chisq[2],2)
df = r$`Chi Df`[2]
p = signif(r$`Pr(>Chisq)`[2],2)
wald.text = ""
if(!is.null(wald)){
est = signif(wald[1],2)
stder = signif(wald[2],2)
t = signif(wald[3],2)
wptext = ""
if(showWaldP & !is.na(wald[4])){
wptext = paste(", Wald p =",signif(wald[4],2))
}
wald.text = paste("beta = ",est,", std.err = ",stder, ", Wald t = ",t,wptext,';')
}
begin = 'There was no significant'
if(p <0.09){
begin = "There was a marginal"
}
if(p < 0.05){
begin = 'There was a significant'
}
return(paste(begin,ef,"(",wald.text,"log likelihood difference =",
loglikDiff,", df = ",df,", Chi Squared =", chi,", p = ",p,")."))
}
getMEText(anova(m5,m6), "main effect of sign length",summary(finalModel)$coef['averageLength_week_1.logcenter',])
getMEText(anova(m6,m7), "main effect of checking",summary(finalModel)$coef['check.anyTRUE',])
anova(m8,m9)
summary(finalModel)$coef
getMEText(anova(m8,m9), "interaction between teaching and checking",summary(finalModel)$coef['TeachTRUE:check.anyTRUE',])
