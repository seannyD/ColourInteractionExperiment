averageLength_week_1.logcenter+
check.any + inventedBy +
+ (1 + indexical || colourName) ,
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.indexical)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + Teach|| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.TryMark = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + TryMarked|| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.TryMark)
m8R.Freq = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + freq_week_1_total|| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Freq)
m8R.Length = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + averageLength_week_1.logcenter| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Length)
m8R.Check = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + check.any| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Check)
dotplot(ranef(m8R.Check))
finalModel = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 + indexical + check.any || colourName) ,
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
dotplot(ranef(finalModel))
dotplot(ranef(m8R.indexical))
dotplot(ranef(m8R.Check))
```{r finalModel, cache=T}
finalModel = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 + indexical || colourName) +
(0 + check.any | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
dotplot(ranef(finalModel))
sjp.glmer(finalModel)
sjp.glmer(finalModel,'fe')
getMEText(anova(m2,m3), "main effect of try marking",summary(finalModel)$coef['TryMarked',])
summary(finalModel)$coef
getMEText(anova(m3,m4), "interaction between try marking and teaching",summary(finalModel)$coef['TeachTRUE:TryMarked',])
getMEText(anova(m0,m1), "main effect of frequency in week 1",summary(finalModel)$coef['freq_week_1_total',])
getMEText(anova(m0,m1), "main effect of indexicality",summary(finalModel)$coef['indexicality',])
summary(finalModel)$coef
getMEText(anova(m5,m6), "main effect of sign length",summary(finalModel)$coef['averageLength_week_1.logcenter',])
getMEText(anova(m6,m7), "main effect of checking",summary(finalModel)$coef['check.anyTRUE',])
summary(finalModel)
coef(summary(finalModel))
coef(summary(finalModel))[,1:3]
exp(0.18)
coef(summary(m7))
plot(variants$Teach, variants$freq_week_4)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + Teach || colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
summary(m8R.Teach)
ranef(m8R.Teach)
ranef(m8R.TryMark)
hist(variants$TryMarked)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
dotplot(ranef(m8R.Teach))
ranef(m8R.Tea)
ranef(m8R.Teach)
table(variants$Teach)
table(variants$Teach, variants$colourName)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + Teach | colourName),
data=variants, family=poisson)
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "Nelder_Mead",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.indexical = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + indexical | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
summary(m8R.indexical)
ranef(m8R.indexical)
table(variants$indexical)
m8R.indexical = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + indexical | colourName),
data=variants, family=poisson)
m8R.indexical = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + indexical | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
ranef(m8R.indexical)
m8R = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 | colourName) ,
data=variants, family=poisson)
# Some convergence issues with this model, so use
# bobyqa algorithm for both steps.
m8R.indexical = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + indexical | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.indexical)
m8R.Teach = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + Teach | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Teach)
m8R.TryMark = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + TryMarked| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.TryMark)
m8R.Freq = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + freq_week_1_total| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Freq)
m8R.Length = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + averageLength_week_1.logcenter| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Length)
m8R.Check = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + check.any| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Check)
m8R.Check = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 | colourName) +
(0 + check.any| colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "Nelder_Mead",
optCtrl = list(maxfun=500000)))
anova(m8R,m8R.Check)
finalModel = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
(1 + indexical || colourName) +
(0 + check.any | colourName),
data=variants, family=poisson,
control=glmerControl(
optimizer = "bobyqa",
optCtrl = list(maxfun=500000)))
coef(summary(finalModel))[,1:3]
coef(summary(finalModel))
coef(summary(finalModel))[,1:3]
plot(variants$freq_week_4, exp(predict(finalModel)),
xlab="Actual frequency",
ylab="Model prediction")
plot(variants$TryMarked, variants$freq_week_4)
plotmeans(variants$freq_week_4~variants$Teach)
library(gplots)
plotmeans(variants$freq_week_4~variants$Teach)
plotmeans(variants[variants$TryMarked.cat=='high',]$freq_week_4~variants[variants$TryMarked.cat=='high',]$Teach)
table(variants$TryMarked.cat)
plotmeans(variants[variants$TryMarked.cat=='High',]$freq_week_4~variants[variants$TryMarked.cat=='High',]$Teach)
plotmeans(variants[variants$TryMarked.cat=='Low',]$freq_week_4~variants[variants$TryMarked.cat=='Low',]$Teach)
hist(variants$Teach)
hist(variants$TryMarked)
plotmeans(variants$Teach~variants$TryMarked)
cor.test(variants$Teach~variants$TryMarked)
cor.test(variants$Teach,variants$TryMarked)
t.test(variants$TryMarked~variants$Teach)
variants2 = read.csv('../data/processedData/variants_summary.csv', stringsAsFactors = F)
table(variants2$Teach
)
m9 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach * check.any
+ (1 | colourName) ,
data=variants, family=poisson)
anova(m0,m1,m2,m3,m4,m5, m6,m7,m8, m9)
m10 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach * check.any * TryMarked
+ (1 | colourName) ,
data=variants, family=poisson)
anova(m0,m1,m2,m3,m4,m5, m6,m7,m8, m9, m10)
plot(variants$freq_week_4, exp(predict(m9)),
xlab="Actual frequency",
ylab="Model prediction")
plot(variants$freq_week_4, exp(predict(m8)),
xlab="Actual frequency",
ylab="Model prediction")
plot(variants$freq_week_4, exp(predict(m9)),
xlab="Actual frequency",
ylab="Model prediction")
m9 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any
+ (1 | colourName) ,
data=variants, family=poisson)
summary(m9)
m0 = glmer(freq_week_4 ~
1
+ (1 | colourName) ,
data=variants, family=poisson)
# add frequency in week 1
m1 = glmer(freq_week_4 ~
1 + freq_week_1_total +
+ (1 | colourName) ,
data=variants, family=poisson)
# add indexicality
m2 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
+ (1 | colourName) ,
data=variants, family=poisson)
# add whether the variant is explicitly taught
m3 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach)
+ (1 | colourName) ,
data=variants, family=poisson)
# Add try marking
m4 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach) + (TryMarked)
+ (1 | colourName) ,
data=variants, family=poisson)
# Add the interaction between teaching and try marking
m5 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
Teach * TryMarked
+ (1 | colourName) ,
data=variants, family=poisson)
# Add the average length of the sign
m6 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter +
(1 | colourName) ,
data=variants, family=poisson)
# Add checks
m7 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any
+ (1 | colourName) ,
data=variants, family=poisson)
# Add the identity of the first signer to use the variant
m8 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy
+ (1 | colourName) ,
data=variants, family=poisson)
# Add interaction between teaching and checking
m9 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any
+ (1 | colourName) ,
data=variants, family=poisson)
# Add interaction between try marking and checking
m10 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach : check.any +
check.any : TryMarked
+ (1 | colourName) ,
data=variants, family=poisson)
# Add 3 way interaction for teaching, checking and try marking
m11 = glmer(freq_week_4 ~
1 + freq_week_1_total +
(indexical) +
(Teach * TryMarked) +
averageLength_week_1.logcenter+
check.any + inventedBy +
Teach * check.any * TryMarked
+ (1 | colourName) ,
data=variants, family=poisson)
anova(m0,m1,m2,m3,m4,m5, m6,m7,m8, m9, m10, m11)
hist(variants$averageLength_week_1)
hist(variants$averageLength_week_1.logcenter)
hist(variants$averageLength_week_1)
35000/1000
